<!--
=========================================================
* Material Dashboard 2 - v3.0.4
=========================================================

* Product Page: https://www.creative-tim.com/product/material-dashboard
* Copyright 2022 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="./assets/img/favicon.png">
    <title>
        Material Dashboard 2 by Creative Tim
    </title>
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css"
          href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900|Roboto+Slab:400,700"/>
    <!-- Nucleo Icons -->
    <link href="./assets/css/nucleo-icons.css" rel="stylesheet"/>
    <link href="./assets/css/nucleo-svg.css" rel="stylesheet"/>
    <!-- Font Awesome Icons -->
    <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
    <!--    Axios-->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- CSS Files -->
    <link id="pagestyle" href="./assets/css/material-dashboard.css?v=3.0.4" rel="stylesheet"/>
</head>
<br>
<br>
<br>
<br>
<div class="container">

<input type="text" id="input-academyName" placeholder="학원 이름">
<input type="text" id="input-academyOwner"  placeholder="학원 대표자명">
<input type="text" id="input-academyAddress"  placeholder="학원 주소">
<input type="text" id="input-academybusinessNum"  placeholder="학원 사업자등록번호">
<input type="text" id="input-academyphoneNum"  placeholder="학원 전화번호">
<button th:onclick="|academy.create()|"  type="button">학원 등록
</button>
</div>
<br>


<div class="container">
    <table class="table table-striped table-hover" style="border-color: #5A2082" border="1">
        <thead class="table-primary">
        <tr>
            <th scope="col">학원 Id</th>
            <th scope="col">학원 이름</th>
            <th scope="col">학원 대표자명</th>
            <th scope="col">학원 주소</th>
            <th scope="col">학원 사업자 등록 번호</th>
            <th scope="col">학원 전화번호</th>
            <th scope="col">삭제</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="academy : ${academies}">
            <th scope="row" th:text="${academy.academyId}"></th>
            <th scope="row" th:text="${academy.name}"></th>
            <th scope="row" th:text="${academy.owner}"></th>
            <th scope="row" th:text="${academy.address}"></th>
            <th scope="row" th:text="${academy.businessRegistrationNumber}"></th>
            <th scope="row" th:text="${academy.phoneNum}"></th>
            <th scope="row"><button th:onclick="|academy.delete(${academy.academyId})|"  type="button">삭제
            </button></th>
        </tr>

        <br>



        </tbody>
    </table>
</div>
<Script>
    let academyId = 0;

    let academy = {
        init: function () {
            var _this = this;
        },
        create: function () {
            let data = {
                name: document.querySelector('#input-academyName').value.trim(),
                address: document.querySelector('#input-academyAddress').value.trim(),
                phoneNum: document.querySelector('#input-academyphoneNum').value.trim(),
                owner: document.querySelector('#input-academyOwner').value.trim(),
                businessRegistrationNumber: document.querySelector('#input-academybusinessNum').value.trim()
            };
            console.log(data);

            axios.post("/api/v1/academies",
                JSON.stringify(data), {
                    headers: {
                        'Content-Type': 'application/json',
                    }
                }
            ).then((response) => {
                console.log(response);
                alert("학원등록 성공");
                window.location.href = '/academies';

            }).catch((error) => {
                console.log(error);
                if (error.response.data.result["errorCode"] == "DUPLICATED_ACADEMY") {
                    alert("학원 이름은 중복될 수 없습니다.");
                    window.location.href = '/academies';
                }


            });

        },

        delete : function (academyId) {

            axios.delete("/api/v1/academies/"+academyId+"/delete",
                 {
                    headers: {
                        'Content-Type': 'application/json',
                    }
                }
            ).then((response) => {
                alert("학원삭제 성공");
                window.location.href = '/academies';
            }).catch((error) => {
            });
        }
    };

    academy.init();

</script>